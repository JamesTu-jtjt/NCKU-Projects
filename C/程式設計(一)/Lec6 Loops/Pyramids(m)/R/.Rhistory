}
}
size.v=c(5,10,20,30,50,100)
n.sim=100
set.seed(10)
old.par=par(mfrow=c(3,2),mar=c(2,2,2,1),mgp=c(1,0.5,0))
for (i in 1:length(size.v)){
standard.v=rep(0,n.sim)
for (j in 1:n.sim){
sample.v=rexp(size.v[i])
standard.v[j]=(mean(sample.v)-1)/sd(sample.v)
p=shapiro.test(sample.v)$p.value
qqnorm(sample.v,main=paste("Sample size",size.v[i]," Sim= ",j,"P-value=",round(p,3)),
cex=0.6,cex.main=0.8,cex.lab=0.7,cex.axis=0.7)
qqline(sample.v)
}
}
size.v=c(5,10,20,30,40,50,100,200,500)
n.sim=200
set.seed(10)
old.par=par(mfrow=c(3,2),mar=c(2,2,2,1),mgp=c(1,0.5,0))
for (i in 1:length(size.v)){
standard.v=rep(0,n.sim)
for (j in 1:n.sim){
sample.v=rbinom(size.v[i])
standard.v[j]=(mean(sample.v)-1)/sd(sample.v)
p=shapiro.test(sample.v)$p.value
qqnorm(sample.v,main=paste("Sample size",size.v[i]," Sim= ",j,"P-value=",round(p,3)),
cex=0.6,cex.main=0.8,cex.lab=0.7,cex.axis=0.7)
qqline(sample.v)
}
}
size.v=c(5,10,20,30,40,50,100,200,500)
n.sim=200
set.seed(10)
old.par=par(mfrow=c(3,2),mar=c(2,2,2,1),mgp=c(1,0.5,0))
for (i in 1:length(size.v)){
standard.v=rep(0,n.sim)
for (j in 1:n.sim){
sample.v=rbinom(size.v[i],0.1)
standard.v[j]=(mean(sample.v)-1)/sd(sample.v)
p=shapiro.test(sample.v)$p.value
qqnorm(sample.v,main=paste("Sample size",size.v[i]," Sim= ",j,"P-value=",round(p,3)),
cex=0.6,cex.main=0.8,cex.lab=0.7,cex.axis=0.7)
qqline(sample.v)
}
}
size.v=c(5,10,20,30,40,50,100,200,500)
n.sim=200
set.seed(10)
old.par=par(mfrow=c(3,2),mar=c(2,2,2,1),mgp=c(1,0.5,0))
for (i in 1:length(size.v)){
standard.v=rep(0,n.sim)
for (j in 1:n.sim){
sample.v=rbinom(10,size.v[i],0.2)
standard.v[j]=(mean(sample.v)-1)/sd(sample.v)
p=shapiro.test(sample.v)$p.value
qqnorm(sample.v,main=paste("Sample size",size.v[i]," Sim= ",j,"P-value=",round(p,3)),
cex=0.6,cex.main=0.8,cex.lab=0.7,cex.axis=0.7)
qqline(sample.v)
}
}
size.v=c(5,10,20,30,40,50,100,200,500)
n.sim=200
set.seed(10)
old.par=par(mfrow=c(3,3),mar=c(2,2,2,1),mgp=c(1,0.5,0))
for (i in 1:length(size.v)){
standard.v=rep(0,n.sim)
for (j in 1:n.sim){
sample.v=rbinom(10,size.v[i],0.2)
standard.v[j]=(mean(sample.v)-1)/sd(sample.v)
p=shapiro.test(sample.v)$p.value
qqnorm(sample.v,main=paste("Sample size",size.v[i]," Sim= ",j,"P-value=",round(p,3)),
cex=0.6,cex.main=0.8,cex.lab=0.7,cex.axis=0.7)
qqline(sample.v)
}
}
size.v=c(5,10,20,30,40,50,100,200,500)
n.sim=200
set.seed(10)
old.par=par(mfrow=c(3,3),mar=c(2,2,2,1),mgp=c(1,0.5,0))
for (i in 1:length(size.v)){
standard.v=rep(0,n.sim)
for (j in 1:n.sim){
sample.v=rbinom(10,size.v[i],0.2)
standard.v[j]=(mean(sample.v)-1)/sd(sample.v)
p=shapiro.test(sample.v)$p.value
qqnorm(sample.v,main=paste("Sample size",size.v[i]," Sim= ",j,"P-value=",round(p,3)),
cex=0.6,cex.main=0.8,cex.lab=0.7,cex.axis=0.7)
qqline(sample.v)
}
}
size.v=c(5,10,20,30,40,50,100,200,500)
n.sim=200
set.seed(10)
old.par=par(mfrow=c(3,3),mar=c(2,2,2,1),mgp=c(1,0.5,0))
for (i in 1:length(size.v)){
standard.v=rep(0,n.sim)
for (j in 1:n.sim){
sample.v=rbinom(size.v[i],10,0.2)
standard.v[j]=(mean(sample.v)-1)/sd(sample.v)
p=shapiro.test(sample.v)$p.value
qqnorm(sample.v,main=paste("Sample size",size.v[i]," Sim= ",j,"P-value=",round(p,3)),
cex=0.6,cex.main=0.8,cex.lab=0.7,cex.axis=0.7)
qqline(sample.v)
}
}
size.v=c(5,10,20,30,40,50,100,200,500)
n.sim=200
set.seed(10)
old.par=par(mfrow=c(3,3),mar=c(2,2,2,1),mgp=c(1,0.5,0))
for (i in 1:length(size.v)){
standard.v=rep(0,n.sim)
for (j in 1:n.sim){
sample.v=rbinom(size.v[i],10,0.2)
standard.v[j]=(mean(sample.v)-1)/sd(sample.v)
p=shapiro.test(sample.v)$p.value
qqnorm(sample.v,main=paste("Sample size",size.v[i]," Sim= ",j,"P-value=",round(p,3)),
cex=0.6,cex.main=0.8,cex.lab=0.7,cex.axis=0.7)
qqline(sample.v)
}
}
size.v=c(5,10,20,30,40,50,100,200,500)
n.sim=200
set.seed(10)
old.par=par(mfrow=c(3,3),mar=c(2,2,2,1),mgp=c(1,0.5,0))
for (i in 1:length(size.v)){
standard.v=rep(0,n.sim)
for (j in 1:n.sim){
sample.v=rbinom(size.v[i],10,0.2)
standard.v[j]=(mean(sample.v)-2)/sqrt(sample.v)
p=shapiro.test(sample.v)$p.value
qqnorm(sample.v,main=paste("Sample size",size.v[i]," Sim= ",j,"P-value=",round(p,3)),
cex=0.6,cex.main=0.8,cex.lab=0.7,cex.axis=0.7)
qqline(sample.v)
}
}
size.v=c(5,10,20,30,40,50,100,200,500)
set.seed(100)
n.sim=200
old.par=par(mfrow=c(3,3),mar=c(2,2,2,1),mgp=c(1,0.5,0))
for (i in 1:length(size.v)){
standard.v=rep(0,n.sim)
for (j in 1:n.sim){
sample.v=rbinom(size.v[i],10,0.2)
standard.v[j]=(mean(sample.v)-2)*sqrt(sample.v)
p=shapiro.test(sample.v)$p.value
qqnorm(sample.v,main=paste("Sample size",size.v[i]," Sim= ",j,"P-value=",round(p,3)),
cex=0.6,cex.main=0.8,cex.lab=0.7,cex.axis=0.7)
qqline(sample.v)
}
}
size.v=c(5,10,20,30,40,50,100,200,500)
set.seed(100)
n.sim=200
old.par=par(mfrow=c(3,3),mar=c(2,2,2,1),mgp=c(1,0.5,0))
for (i in 1:length(size.v)){
standard.v=rep(0,n.sim)
for (j in 1:n.sim){
sample.v=rbinom(size.v[i],10,0.2)
standard.v[j]=sqrt(size.v[i])*(mean(sample.v)-2)/sqrt(var(sample.v))
p=shapiro.test(sample.v)$p.value
qqnorm(sample.v,main=paste("Sample size",size.v[i]," Sim= ",j,"P-value=",round(p,3)),
cex=0.6,cex.main=0.8,cex.lab=0.7,cex.axis=0.7)
qqline(sample.v)
}
}
#X~Bin(10,p=0.2)
#Sim.n=200
#Sample size: 5,10,20,30,40,50,100,200,500
size.v=c(5,10,20,30,40,50,100,200,500)
set.seed(100)
n.sim=200
old.par=par(mfrow=c(3,3),mar=c(2,2,2,1),mgp=c(1,0.5,0))
for (i in 1:length(size.v)){
standard.v=rep(0,n.sim)
for (j in 1:n.sim){
sample.v=rbinom(size.v[i],10,prob=0.2)
standard.v[j]=sqrt(size.v[i])*(mean(sample.v)-2)/sqrt(var(sample.v))
}
p=shapiro.test(sample.v)$p.value
qqnorm(sample.v,main=paste("Sample size",size.v[i]," Sim= ",j,"P-value=",round(p,3)),
cex=0.6,cex.main=0.8,cex.lab=0.7,cex.axis=0.7)
qqline(sample.v)
}
size.v=c(5,10,20,30,40,50,100,200,500)
set.seed(100)
n.sim=200
old.par=par(mfrow=c(3,3),mar=c(2,2,2,1),mgp=c(1,0.5,0))
for (i in 1:length(size.v)){
standard.v=rep(0,n.sim)
for (j in 1:n.sim){
sample.v=rbinom(size.v[i],10,prob=0.2)
standard.v[j]=sqrt(size.v[i])*(mean(sample.v)-2)/sqrt(var(sample.v))
}
p=shapiro.test(sample.v)$p.value
qqnorm(sample.v,main=paste("Sample size",size.v[i],"P-value=",round(p,3)),
cex=0.6,cex.main=0.8,cex.lab=0.7,cex.axis=0.7)
qqline(standard.v)
}
size.v=c(5,10,20,30,40,50,100,200,500)
set.seed(100)
n.sim=200
old.par=par(mfrow=c(3,3),mar=c(2,2,2,1),mgp=c(1,0.5,0))
for (i in 1:length(size.v)){
standard.v=rep(0,n.sim)
for (j in 1:n.sim){
sample.v=rbinom(size.v[i],10,prob=0.2)
standard.v[j]=sqrt(size.v[i])*(mean(sample.v)-2)/sqrt(var(sample.v))
}
p=shapiro.test(standard.v)$p.value
qqnorm(standard.v,main=paste("Sample size",size.v[i],"P-value=",round(p,3)),
cex=0.6,cex.main=0.8,cex.lab=0.7,cex.axis=0.7)
qqline(standard.v)
}
size.v=c(5,10,20,30,50,100)
n.sim=100
set.seed(10)
old.par=par(mfrow=c(3,2),mar=c(2,2,2,1),mgp=c(1,0.5,0))
for (i in 1:length(size.v)){
standard.v=rep(0,n.sim)
for (j in 1:n.sim){
sample.v=rexp(size.v[i])
standard.v[j]=sqrt(size.v[i])*(mean(sample.v)-1)/sqrt(var(sample.v))
}
p=shapiro.test(standard.v)$p.value
qqnorm(standard.v,main=paste("Sample size",size.v[i]," Sim= ",j,"P-value=",round(p,3)),
cex=0.6,cex.main=0.8,cex.lab=0.7,cex.axis=0.7)
qqline(standard.v)
}
H3 <- matrix(c(1, 1/2, 1/3, 1/2, 1/3, 1/4, 1/3, 1/4, 1/5), nrow=3)
H3
1/cbind(seq(1, 3), seq(2, 4), seq(3, 5))
cbind(seq(1, 3), seq(2, 4), seq(3, 5))
matrix(seq(1, 12), nrow=3)
X=matrix(seq(1, 12), nrow=3)
class(X[3, , drop = FALSE])
class(X[3, , drop = FALSE])
class(X[3,])
p1=runif(100000,-4,4)
q1=runif(100000)
x1=p[q<dnorm(p)]
hist(x)
p2=rexp(100000)
q2=rexp(100000)
x2=c(p2[q2<dnorm(p2)],-p2[q2<dnorm(-p2)])
hist(x2)
p2=rexp(100000)
q2=runif(100000)
x2=c(p2[q2<dnorm(p2)],-p2[q2<dnorm(-p2)])
hist(x2)
p1=runif(100000,-4,4)
q1=runif(100000)
x1=p[q1<dnorm(p1)]
return(x1)
p1=runif(100000,-4,4)
q1=runif(100000)
x1=p[q1<dnorm(p1)]
#Exercise 1
snp1=function(){
p1=runif(100000,-4,4)
q1=runif(100000)
x1=p[q1<dnorm(p1)]
return(x1)
}
hist(snp1())
snp1=function(){
p1=runif(100000,-4,4)
q1=runif(100000)
x1=p[q1<dnorm(p1)]
return(x1)
}
hist(snp1())
snp2=function(){
p2=rexp(100000)
q2=runif(100000)
x2=c(p2[q2<dnorm(p2)],-p2[q2<dnorm(-p2)])
return(x2)
}
hist(snp2())
snp1=function(){
p1=runif(100000,-4,4)
q1=runif(100000)
x1=p[q1<dnorm(p1)]
return(x1)
}
hist(snp1())
x=runif(1000000, 0, 3)
pi=3.1415926
mean(exp(-x^2/2)/sqrt(2*pi))*3
snp1=function(){
p1=runif(100000,-4,4)
q1=runif(100000)
x1=p[q1<dnorm(p1)]
return(x1)
}
hist(snp1(),10)
hist(snp1(),breaks=10)
x=runif(1000000, 0, 3)
mean(sin(exp(x)))*3
x <- runif(1000000, min = 0, max = 2)
y <- runif(1000000, min = 0, max = 5)
mean(exp(-(x+y)^2)*(x+y)^2)*10
x <- runif(1000000, min = 0, max = 2)
y <- runif(1000000, min = 0, max = 5)
mean(exp(-(x+y)^2)*(x+y)^2)*10
snp1=function(){
p1=runif(100000,-4,4)
return(p1)
}
hist(snp1())
snp1=function(){
p1=runif(100000)
p1=p1[p1<4&&p1>-4]
return(p1)
}
snp1=function(){
p1=runif(100000)
p1=p1[p1<4&&p1>-4]
return(p1)
}
hist(snp1())
snp1=function(){
p1=runif(100000,-4,4)
q1=runif(100000)
x1=p1[q1<dnorm(p1)]
return(x1)
}
hist(snp1())
snp2=function(){
p2=rexp(100000)
q2=runif(100000)
x2=c(p2[q2<dnorm(p2)],-p2[q2<dnorm(-p2)])
return(x2)
}
hist(snp2())
H3 <- matrix(c(1, 1/2, 1/3, 1/2, 1/3, 1/4, 1/3, 1/4, 1/5), nrow=3)
H3
cbind(seq(1, 3), seq(2, 4), seq(3, 5))
1/cbind(seq(1, 3), seq(2, 4), seq(3, 5))
X=matrix(seq(1, 12), nrow=3)
class(X[3, , drop = FALSE])
class(X[3,])
rownames(H3)=c("A","B","C")
colnames(H3)=c("Red","Blue","Yellow")
H3
H3[c("B","C"),"Yellow"]
H3.fr=as.data.frame(H3)
H3.fr$Red
H3.fr$A
dim(H3)
det(H3)
diag(H3)
trace=function(data) sum(diag(data))
trace(H3)
diag(diag(H3))
diag(c(1,2,3))
summary(H3)
M=matrix(1:16,nrow=4)
M=matrix(1:16,nrow=4)
out=c(det(M),det(t(M)))
out
set.seed(10)
M=matrix(rnorm(16),nrow=4)
out=c(det(M),det(t(M)))
out
?set.seed
lower.tri(H3)
H3[lower.tri(H3)]
Hnew=H3
Hnew[upper.tri(H3,diag=T)]=0
Hnew
t(H[,c(1,3)])
t(H3[,c(1,3)])
t(H3[,c(1,3)])+H3
t(H3[,c(1,3)])*H3
t(H3[,c(1,3)])*H3[,c(1,3)]
H3[,c(1,3)]^2
H3%*%H3
t(H3[,c(1,3)])*H3[,c(1,3)]
t(H3[,c(1,3)])*H3[,c(1,3)]
t(H3[,c(1,3)])
H3[,c(1,3)]
t(H3[,c(1,3)])*H3[,c(1,3)]
t(H3[,c(1,3)])*H3[,c(1,3)]
crossprod(H3[,c(1,3)],H3[,c(1,3)])
H3inv<-solve(H3)
H3*H3inv
H3inv<-solve(H3)
H3inv*H3
H3 <- matrix(c(1, 1/2, 1/3, 1/2, 1/3, 1/4, 1/3, 1/4, 1/5), nrow=3)
H3
H3inv<-solve(H3)
H3inv*H3
H3inv<-solve(H3)
H3inv*H3
H3inv*H3
eigen(H3)
t(H3[,c(1,3)])*H3[,c(1,3)]
t(H3[,c(1,3)])*(H3[,c(1,3)])
t(H3[,c(1,3)])+H3[,c(1,3)]
t(H3[,c(1,3)])*(H3[,c(1,3)])
I3=matrix(c(1,0,0,0,1,0,0,0,1),ncol=3)
I3
X <- matrix(c(1, 2, 3, 1, 4, 9), ncol=2)
H=X%*%solve(t(X)%*%X)%*%t(X)
H
#           [,1]      [,2]       [,3]
#[1,]  0.5263158 0.4736842 -0.1578947
#[2,]  0.4736842 0.5263158  0.1578947
#[3,] -0.1578947 0.1578947  0.9473684
#2
eigen(H)
#$values
#[1] 1.000000e+00 1.000000e+00 6.661338e-16
#$vectors
#          [,1]       [,2]       [,3]
#[1,] 0.0000000 -0.7254763  0.6882472
#[2,] 0.3162278 -0.6529286 -0.6882472
#[3,] 0.9486833  0.2176429  0.2294157
#3
trace(H)
#[1] 2
sum(eigen(H)$values)
#[1] 2
#4
det(H)
#[1] -1.752984e-17
eigen(H)$values[1]*eigen(H)$values[2]*eigen(H)$values[3]
#[1] 6.661338e-16
H%*%(I3-H[,1])
1%*%(I3-H[,1])
1%*%X[,1]
H1=I3-H
H%*%H1[,1]
1%*%H1[,1]
H%*%H1[,2]
1%*%H1[,2]
H%*%H1[,3]
1%*%H1[,3]
as.integer(det(H))
as.integer(det(H))
as.integer(eigen(H)$values[1]*eigen(H)$values[2]*eigen(H)$values[3])
H1=I3-H
as.integer(H%*%H1[,1])
H%*%H1[,1]
0%*%H1[,2]
6.661338e-16%*%H1[,3]
H%*%H1[,3]
as.integer(6.661338e-16%*%H1[,1])
1%*%X[,1]
H%*%X[,1]
1%*%X[,1]
H%*%X[,2]
1%*%X[,2]
t=runif(1000000,6,7)
u=runif(1000000,7,8)
v=runif(1000000,8,9)
w=runif(1000000,9,10)
x=runif(1000000,10,11)
y=runif(1000000,1,2)
z=runif(1000000,2,4)
a=runif(1000000,4,8)
b=runif(1000000,3,6)
c=runif(1000000,5,10)
mean((t+u+v+w+x)*(y+z+a+b+c)^(1/5))*2*3*4*5
Y=function(size){
x1=runif(size,0,6)
x2=runif(size,2,4)
return(x1+x2)
}
size.v=c(5,10,30,100)
n.sim=100
set.seed(10)
old.par=par(mfrow=c(2,2),mar=c(2,2,2,1),mgp=c(1,0.5,0))
for (i in 1:length(size.v)){
standard.v=rep(0,n.sim)
for (j in 1:n.sim){
sample.v=Y(size.v)
standard.v[j]=sqrt(size.v[i])*(mean(sample.v)-1)/sqrt(var(sample.v))
}
p=shapiro.test(standard.v)$p.value
qqnorm(standard.v,main=paste("Sample size",size.v[i]," Sim= ",j,"P-value=",round(p,3)),
cex=0.6,cex.main=0.8,cex.lab=0.7,cex.axis=0.7)
qqline(standard.v)
}
as.integer(H%*%H1[,1])==as.integer(6.661338e-16%*%H1[,1])
as.vector(H%*%H1[,1])==as.vector(6.661338e-16%*%H1[,1])
set.seed(10)
t=runif(1000000,6,7)
u=runif(1000000,7,8)
v=runif(1000000,8,9)
w=runif(1000000,9,10)
x=runif(1000000,10,11)
y=runif(1000000,1,2)
z=runif(1000000,2,4)
a=runif(1000000,4,8)
b=runif(1000000,3,6)
c=runif(1000000,5,10)
mean((t+u+v+w+x)*(y+z+a+b+c)^(1/5))*2*3*4*5
set.seed(10)
t=runif(1000000,6,7)
u=runif(1000000,7,8)
v=runif(1000000,8,9)
w=runif(1000000,9,10)
x=runif(1000000,10,11)
y=runif(1000000,1,2)
z=runif(1000000,2,4)
a=runif(1000000,4,8)
b=runif(1000000,3,6)
c=runif(1000000,5,10)
mean((t+u+v+w+x)*(y+z+a+b+c)^(1/5))*2*3*4*5
